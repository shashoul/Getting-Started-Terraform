{"title":"Troubleshoot Serverless Log Ingestion","description":"You can find detailed documentation for the Datadog Forwarder [here](https://docs.datadoghq.com/serverless/forwarder), and serverless monitoring installation instructions [here](https://docs.datadoghq.com/serverless/installation).\n\nIf you are unsure how to proceed, send a screenshot of this dashboard to [Datadog support](https://www.datadoghq.com/support/) after following the instructions.","widgets":[{"id":0,"layout":{"x":0,"y":31,"width":36,"height":50},"definition":{"title":"Installed Forwarders by Region","title_size":"16","title_align":"left","type":"query_table","requests":[{"q":"exclude_null(sum:aws.lambda.invocations{$region} by {functionname,region,dd_forwarder_version})","aggregator":"sum","limit":50,"order":"desc","alias":"Invocations"}],"custom_links":[]}},{"id":1,"layout":{"x":0,"y":13,"width":36,"height":18},"definition":{"type":"note","content":"# Step 1\n\nStart by using the above template variables to specify the `region` you are interested in debugging.\n\nThe Datadog Forwarder must be deployed in every region where AWS Lambda functions are sending logs or traces to Datadog.","background_color":"yellow","font_size":"14","text_align":"left","show_tick":false,"tick_pos":"50%","tick_edge":"left"}},{"id":2,"layout":{"x":74,"y":13,"width":36,"height":24},"definition":{"type":"note","content":"# Step 3\n\nEnter the function name of the relevant Datadog Forwarder in **both** the `forwarderfunction` and the `forwardername` template variables in lowercase.\n\nIf the Forwarder is being invoked but logs aren't being sent to Datadog:\n\n- Ensure your [Datadog API key](https://docs.datadoghq.com/serverless/forwarder#installation) is properly configured\n- Validate your forwarder information in the \"Collect Logs\" tab of the AWS integration tile\n\n","background_color":"yellow","font_size":"14","text_align":"left","show_tick":false,"tick_pos":"50%","tick_edge":"left"}},{"id":3,"layout":{"x":74,"y":37,"width":36,"height":15},"definition":{"title":"Datadog Forwarder Invocations","title_size":"16","title_align":"left","show_legend":false,"type":"timeseries","requests":[{"q":"sum:aws.lambda.invocations{$region,$forwarderfunction}.as_count()","on_right_yaxis":false,"style":{"palette":"cool","line_type":"solid","line_width":"normal"},"display_type":"line"},{"q":"sum:aws.lambda.errors{$region,$forwarderfunction}.as_count()","on_right_yaxis":false,"style":{"palette":"warm","line_type":"solid","line_width":"normal"},"display_type":"bars"},{"q":"sum:aws.lambda.throttles{$region,$forwarderfunction}.as_count()","on_right_yaxis":false,"style":{"palette":"purple","line_type":"solid","line_width":"normal"},"display_type":"bars"}],"yaxis":{"scale":"linear","label":"","include_zero":true,"min":"auto","max":"auto"},"custom_links":[]}},{"id":4,"layout":{"x":37,"y":13,"width":36,"height":24},"definition":{"type":"note","content":"# Step 2\n\nEnter the name of a log group you expect to be sending logs to Datadog in the `loggroupname` template variable above in lowercase.\n\nBy default, your log group will be your function name prefixed by `/aws/lambda/`.\n\nIf log events are not being generated by the function, you should double check your AWS permissions on the function to ensure it has permissions to generate logs.","background_color":"yellow","font_size":"14","text_align":"left","show_tick":false,"tick_pos":"50%","tick_edge":"left"}},{"id":5,"layout":{"x":37,"y":66,"width":36,"height":15},"definition":{"title":"Log Events Sent to Forwarder","title_size":"16","title_align":"left","show_legend":false,"type":"timeseries","requests":[{"q":"sum:aws.logs.forwarded_log_events{destinationtype:lambda,$loggroupname,$region}.as_count()","style":{"palette":"dog_classic","line_type":"solid","line_width":"normal"},"display_type":"line"}],"yaxis":{"scale":"linear","label":"","include_zero":true,"min":"auto","max":"auto"},"custom_links":[]}},{"id":6,"layout":{"x":37,"y":37,"width":36,"height":15},"definition":{"title":"Log Events Generated by Function","title_size":"16","title_align":"left","show_legend":false,"type":"timeseries","requests":[{"q":"sum:aws.logs.incoming_log_events{$loggroupname,$region}.as_count()","style":{"palette":"dog_classic","line_type":"solid","line_width":"normal"},"display_type":"line"}],"yaxis":{"scale":"linear","label":"","include_zero":true,"min":"auto","max":"auto"},"custom_links":[]}},{"id":7,"layout":{"x":74,"y":66,"width":36,"height":15},"definition":{"title":"Logs Forwarded to Datadog","title_size":"16","title_align":"left","show_legend":false,"legend_size":"0","type":"timeseries","requests":[{"q":"sum:aws.dd_forwarder.logs_forwarded{$forwardername}.as_count()","style":{"palette":"dog_classic","line_type":"solid","line_width":"normal"},"display_type":"line"}],"yaxis":{"scale":"linear","label":"","include_zero":true,"min":"auto","max":"auto"},"custom_links":[]}},{"id":8,"layout":{"x":0,"y":0,"width":110,"height":13},"definition":{"type":"note","content":"# Troubleshoot Datadog Serverless Log Ingestion\n\nYou can find detailed documentation for the Datadog Forwarder [here](https://docs.datadoghq.com/serverless/forwarder), and serverless monitoring installation instructions [here](https://docs.datadoghq.com/serverless/installation).\n\nIf you are unsure how to proceed, send a screenshot of this dashboard to [Datadog support](https://www.datadoghq.com/support/) after following the instructions.","background_color":"blue","font_size":"14","text_align":"left","show_tick":false,"tick_pos":"50%","tick_edge":"left"}},{"id":9,"layout":{"x":37,"y":52,"width":36,"height":14},"definition":{"type":"note","content":"If log events are not being forwarded, you should double-check your function's log group's subscriptions.\n\nLog group subscriptions can be configured [automatically](https://docs.datadoghq.com/integrations/amazon_web_services/?tab=automaticcloudformation#role-delegation), [manually](https://docs.datadoghq.com/integrations/amazon_web_services/?tab=manual#role-delegation), or managed via one of [Datadog's developer tool plugins](https://docs.datadoghq.com/serverless/serverless_integrations#datadog-serverless-plugin).","background_color":"yellow","font_size":"14","text_align":"left","show_tick":false,"tick_pos":"50%","tick_edge":"left"}},{"id":10,"layout":{"x":74,"y":52,"width":36,"height":14},"definition":{"type":"note","content":"You should be able to see your AWS Lambda logs in Datadog if:\n\n- The Datadog Forwarder is subscribed to your function's log group\n- Datadog Forwarder logs are being sent to Datadog","background_color":"yellow","font_size":"14","text_align":"left","show_tick":false,"tick_pos":"50%","tick_edge":"left"}}],"template_variables":[{"name":"region","default":"*","prefix":"region"},{"name":"loggroupname","default":"*","prefix":"loggroupname"},{"name":"forwarderfunction","default":"*","prefix":"functionname"},{"name":"forwardername","default":"*","prefix":"forwardername"}],"layout_type":"free","is_read_only":true,"notify_list":[],"id":30390}