{"title":"Azure SQL Databases","description":"This dashboard provides key Azure SQL Database metrics so you can monitor your databases' resource consumption and storage capacity and spot potential issues at a glance. For further reading on monitoring Azure SQL Databases: \n\n- [How to monitor Azure SQL Databases with Datadog](https://www.datadoghq.com/blog/monitor-azure-sql-databases-datadog/) \n\n- [Datadogâ€™s Azure SQL Databases integration docs](https://docs.datadoghq.com/integrations/azure_sql_database/). \n\nClone this template dashboard to make changes and add your own graph widgets.","widgets":[{"id":0,"layout":{"x":79,"y":22,"width":56,"height":15},"definition":{"title":"CPU utilization per database","title_size":"16","title_align":"left","show_legend":false,"legend_size":"0","type":"timeseries","requests":[{"q":"avg:azure.sql_servers_databases.cpu_percent{$tenant,$subscription,$resource_group} by {name}","style":{"palette":"cool","line_type":"solid","line_width":"normal"},"display_type":"line"}],"yaxis":{"scale":"linear","label":"","include_zero":true,"min":"auto","max":"auto"},"custom_links":[]}},{"id":1,"layout":{"x":22,"y":38,"width":56,"height":15},"definition":{"title":"Used storage per database","title_size":"16","title_align":"left","show_legend":false,"legend_size":"0","type":"timeseries","requests":[{"q":"avg:azure.sql_servers_databases.storage_percent{$tenant,$subscription,$resource_group} by {name}","style":{"palette":"cool","line_type":"solid","line_width":"normal"},"display_type":"line"}],"yaxis":{"scale":"linear","label":"","include_zero":true,"min":"auto","max":"auto"},"custom_links":[]}},{"id":2,"layout":{"x":22,"y":0,"width":27,"height":15},"definition":{"title":"Successful connections","title_size":"16","title_align":"left","time":{"live_span":"1h"},"type":"query_value","requests":[{"q":"sum:azure.sql_servers_databases.connection_successful{$tenant,$subscription,$resource_group}","aggregator":"sum"}],"autoscale":true,"custom_unit":"conns","text_align":"center","custom_links":[]}},{"id":3,"layout":{"x":79,"y":70,"width":56,"height":15},"definition":{"title":"Deadlocks per database","title_size":"16","title_align":"left","show_legend":false,"legend_size":"0","type":"timeseries","requests":[{"q":"avg:azure.sql_servers_databases.deadlock{$tenant,$subscription,$resource_group} by {name}","style":{"palette":"warm","line_type":"solid","line_width":"normal"},"display_type":"line"}],"yaxis":{"scale":"linear","label":"","include_zero":true,"min":"auto","max":"auto"},"custom_links":[]}},{"id":4,"layout":{"x":0,"y":0,"width":21,"height":21},"definition":{"type":"image","url":"/static/images/logos/azure-sql-database_avatar.svg","sizing":"center"}},{"id":5,"layout":{"x":79,"y":38,"width":56,"height":15},"definition":{"title":"DTU utilization per database","title_size":"16","title_align":"left","show_legend":false,"legend_size":"0","type":"timeseries","requests":[{"q":"avg:azure.sql_servers_databases.dtu_consumption_percent{$tenant,$subscription,$resource_group} by {name}","style":{"palette":"cool","line_type":"solid","line_width":"normal"},"display_type":"area"}],"yaxis":{"scale":"linear","label":"","include_zero":true,"min":"auto","max":"auto"},"custom_links":[]}},{"id":6,"layout":{"x":51,"y":-1,"width":27,"height":15},"definition":{"title":"Failed connections","title_size":"16","title_align":"left","time":{"live_span":"1h"},"type":"query_value","requests":[{"q":"sum:azure.sql_servers_databases.connection_failed{$tenant,$subscription,$resource_group}","aggregator":"sum","conditional_formats":[{"comparator":">","palette":"white_on_red","value":0}]}],"autoscale":true,"custom_unit":"conns","custom_links":[]}},{"id":7,"layout":{"x":22,"y":54,"width":56,"height":15},"definition":{"title":"Connections blocked by firewall per database","title_size":"16","title_align":"left","show_legend":false,"legend_size":"0","type":"timeseries","requests":[{"q":"avg:azure.sql_servers_databases.blocked_by_firewall{$tenant,$subscription,$resource_group} by {name}","style":{"palette":"warm","line_type":"solid","line_width":"normal"},"display_type":"line"}],"yaxis":{"scale":"linear","label":"","include_zero":true,"min":"auto","max":"auto"},"custom_links":[]}},{"id":8,"layout":{"x":22,"y":22,"width":56,"height":15},"definition":{"title":"Total storage per database","title_size":"16","title_align":"left","type":"toplist","requests":[{"q":"top(sum:azure.sql_servers_databases.storage{$tenant,$subscription,$resource_group} by {name}, 10, 'mean', 'desc')"}],"custom_links":[]}},{"id":9,"layout":{"x":136,"y":22,"width":56,"height":15},"definition":{"title":"Backups per database, by link state","title_size":"16","title_align":"left","show_legend":false,"legend_size":"0","type":"timeseries","requests":[{"q":"sum:azure.sql_servers_databases.replication_links.count{$tenant,$subscription,$resource_group} by {database_name,state}","style":{"palette":"dog_classic","line_type":"solid","line_width":"normal"},"display_type":"area"}],"yaxis":{"scale":"linear","label":"","include_zero":true,"min":"auto","max":"auto"},"custom_links":[]}},{"id":10,"layout":{"x":136,"y":70,"width":56,"height":15},"definition":{"title":"Unhealthy Replication Link Details","title_size":"16","title_align":"left","type":"query_table","requests":[{"q":"sum:azure.sql_servers_databases.replication_links.count{$tenant,$subscription,$resource_group,!state:catch_up} by {database_name,secondary_server_region,state}","aggregator":"last","limit":5,"order":"desc","alias":"Link Count"}],"custom_links":[]}},{"id":11,"layout":{"x":30,"y":88,"width":40,"height":7},"definition":{"type":"note","content":"A high number of blocked connection attempts could indicate a misconfiguration of your firewall. [Learn more](https://docs.microsoft.com/en-us/azure/sql-database/sql-database-firewall-configure)","background_color":"yellow","font_size":"14","text_align":"left","show_tick":false,"tick_pos":"50%","tick_edge":"left"}},{"id":12,"layout":{"x":87,"y":88,"width":40,"height":7},"definition":{"type":"note","content":"Locks occur when one query holds a lock on objects in the database while others try to access the same objects. [Learn more](https://docs.microsoft.com/en-us/azure/sql-database/sql-database-monitor-tune-overview)","background_color":"yellow","font_size":"14","text_align":"left","show_tick":false,"tick_pos":"50%","tick_edge":"left"}},{"id":13,"layout":{"x":144,"y":88,"width":40,"height":9},"definition":{"type":"note","content":"Geo-replication is a business continuity solution that enables quick failover to a secondary database in a different Azure region. [Learn more](https://docs.microsoft.com/en-us/azure/sql-database/sql-database-active-geo-replication)","background_color":"yellow","font_size":"14","text_align":"left","show_tick":false,"tick_pos":"50%","tick_edge":"left"}},{"id":14,"layout":{"x":195,"y":22,"width":51,"height":19},"definition":{"type":"note","content":"\n**Catch-up** indicates the link is healthy and is being constantly synchronized with the primary database.\n\n**Pending** indicates creation of the secondary database is scheduled but not yet completed.\n\n**Seeding** indicates that the two databases are not yet synchronized.\n\n**Suspended** typically indicates that the bandwidth is insufficient and databases may not be synchronized.","background_color":"yellow","font_size":"14","text_align":"left","show_tick":false,"tick_pos":"50%","tick_edge":"left"}},{"id":15,"layout":{"x":136,"y":0,"width":27,"height":15},"definition":{"title":"Backup Servers","title_size":"16","title_align":"left","type":"query_value","requests":[{"q":"sum:azure.sql_servers_databases.replication_links.count{*}","aggregator":"last"}],"autoscale":true,"custom_links":[],"precision":2}},{"id":16,"layout":{"x":22,"y":16,"width":56,"height":5},"definition":{"type":"note","content":"Storage + Network","background_color":"gray","font_size":"18","text_align":"center","show_tick":false,"tick_pos":"50%","tick_edge":"bottom"}},{"id":17,"layout":{"x":79,"y":16,"width":56,"height":5},"definition":{"type":"note","content":"Utilization","background_color":"gray","font_size":"18","text_align":"center","show_tick":false,"tick_pos":"50%","tick_edge":"bottom"}},{"id":18,"layout":{"x":136,"y":16,"width":56,"height":5},"definition":{"type":"note","content":"Geo Replication","background_color":"gray","font_size":"18","text_align":"center","show_tick":false,"tick_pos":"50%","tick_edge":"bottom"}},{"id":19,"layout":{"x":164,"y":0,"width":28,"height":15},"definition":{"title":"Healthy Replication Links","title_size":"16","title_align":"left","type":"query_value","requests":[{"q":"100*sum:azure.sql_servers_databases.replication_links.count{state:catch_up}/sum:azure.sql_servers_databases.replication_links.count{*}","aggregator":"avg","conditional_formats":[{"comparator":">=","palette":"white_on_green","value":99},{"comparator":">=","palette":"white_on_yellow","value":90},{"comparator":">=","palette":"white_on_red","value":0}]}],"autoscale":true,"custom_unit":"%","custom_links":[],"precision":2}},{"id":20,"layout":{"x":79,"y":0,"width":27,"height":15},"definition":{"title":"CPU Utilization","title_size":"16","title_align":"left","type":"query_value","requests":[{"q":"avg:azure.sql_servers_databases.cpu_percent{$tenant,$subscription,$resource_group}","aggregator":"avg"}],"custom_links":[],"precision":2}},{"id":21,"layout":{"x":107,"y":0,"width":28,"height":15},"definition":{"title":"DTUs Used","title_size":"16","title_align":"left","type":"query_value","requests":[{"q":"sum:azure.sql_servers_databases.dtu_used{$tenant,$subscription,$resource_group}","aggregator":"avg"}],"custom_unit":"DTUs","custom_links":[],"precision":2}},{"id":22,"layout":{"x":136,"y":38,"width":56,"height":15},"definition":{"title":"Differential Backup Storage Size","title_size":"16","title_align":"left","show_legend":false,"legend_size":"0","type":"timeseries","requests":[{"q":"avg:azure.sql_servers_databases.differential_backup_storage_size{$tenant,$subscription,$resource_group} by {name}","style":{"palette":"warm","line_type":"solid","line_width":"normal"},"display_type":"line"}],"yaxis":{"scale":"linear","label":"","include_zero":true,"min":"auto","max":"auto"},"custom_links":[]}},{"id":23,"layout":{"x":22,"y":70,"width":56,"height":15},"definition":{"title":"TempDB Log File Size","title_size":"16","title_align":"left","show_legend":false,"legend_size":"0","type":"timeseries","requests":[{"q":"avg:azure.sql_servers_databases.tempdb_log_file_size_kilobytes{$tenant,$subscription,$resource_group} by {name}","style":{"palette":"warm","line_type":"solid","line_width":"normal"},"display_type":"line"}],"yaxis":{"scale":"linear","label":"","include_zero":true,"min":"auto","max":"auto"},"custom_links":[]}},{"id":24,"layout":{"x":79,"y":54,"width":56,"height":15},"definition":{"title":"Concurrent Sessions Percentage","title_size":"16","title_align":"left","show_legend":false,"legend_size":"0","type":"timeseries","requests":[{"q":"avg:azure.sql_servers_databases.sessions_percent{$tenant,$subscription,$resource_group} by {name}","style":{"palette":"warm","line_type":"solid","line_width":"normal"},"display_type":"line"}],"yaxis":{"scale":"linear","label":"","include_zero":true,"min":"auto","max":"auto"},"custom_links":[]}},{"id":25,"layout":{"x":136,"y":54,"width":56,"height":15},"definition":{"title":"Backup Storage Size","title_size":"16","title_align":"left","show_legend":false,"legend_size":"0","type":"timeseries","requests":[{"q":"avg:azure.sql_servers_databases.full_backup_storage_size{$tenant,$subscription,$resource_group} by {name}","style":{"palette":"warm","line_type":"solid","line_width":"normal"},"display_type":"line"}],"yaxis":{"scale":"linear","label":"","include_zero":true,"min":"auto","max":"auto"},"custom_links":[]}}],"template_variables":[{"name":"tenant","default":"*","prefix":"tenant_name"},{"name":"subscription","default":"*","prefix":"subscription_name"},{"name":"resource_group","default":"*","prefix":"resource_group"}],"layout_type":"free","is_read_only":true,"notify_list":[],"id":93}