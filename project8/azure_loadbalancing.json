{"title":"Azure Load Balancer","description":"This dashboard provides an overview of the performance and health of your Azure Load Balancers.\n\nClone this template dashboard to customize and add your own graph widgets.","widgets":[{"id":0,"layout":{"x":22,"y":1,"width":48,"height":5},"definition":{"type":"note","content":"Availability","background_color":"gray","font_size":"18","text_align":"center","show_tick":true,"tick_pos":"50%","tick_edge":"bottom"}},{"id":1,"layout":{"x":22,"y":32,"width":48,"height":19},"definition":{"title":"VIP Availability","title_size":"16","title_align":"left","show_legend":false,"legend_size":"0","type":"timeseries","requests":[{"q":"avg:azure.network_loadbalancers.data_path_availability{$region,$resource_group,$subscription_name,$tenant,$lb_name} by {name,resource_group,region}","style":{"palette":"cool","line_type":"solid","line_width":"normal"},"display_type":"line"}],"yaxis":{"scale":"linear","label":"","include_zero":true,"min":"auto","max":"auto"},"custom_links":[]}},{"id":2,"layout":{"x":71,"y":1,"width":48,"height":5},"definition":{"type":"note","content":"Network Traffic","background_color":"gray","font_size":"18","text_align":"center","show_tick":true,"tick_pos":"50%","tick_edge":"bottom"}},{"id":3,"layout":{"x":71,"y":7,"width":48,"height":24},"definition":{"title":"Network I/O by Bytes","title_size":"16","title_align":"left","show_legend":false,"legend_size":"0","type":"timeseries","requests":[{"q":"sum:azure.network_loadbalancers.byte_count{direction:out,$region,$resource_group,$subscription_name,$tenant,$lb_name}.as_count()","style":{"palette":"green","line_type":"solid","line_width":"normal"},"display_type":"area"},{"q":"0-sum:azure.network_loadbalancers.byte_count{direction:in,$region,$resource_group,$subscription_name,$tenant,$lb_name}.as_count()","style":{"palette":"purple","line_type":"solid","line_width":"normal"},"display_type":"area"}],"yaxis":{"scale":"linear","label":"","include_zero":true,"min":"auto","max":"auto"},"custom_links":[]}},{"id":4,"layout":{"x":71,"y":52,"width":48,"height":20},"definition":{"title":"SYN Packet Count","title_size":"16","title_align":"left","show_legend":false,"legend_size":"0","type":"timeseries","requests":[{"q":"sum:azure.network_loadbalancers.syn_count{$region,$resource_group,$subscription_name,$tenant,$lb_name} by {name,resource_group,region}.as_count()","style":{"palette":"dog_classic","line_type":"solid","line_width":"normal"},"display_type":"line"}],"yaxis":{"scale":"linear","label":"","include_zero":true,"min":"auto","max":"auto"},"custom_links":[]}},{"id":5,"layout":{"x":22,"y":7,"width":23,"height":8},"definition":{"title":"Standard LBs","title_size":"16","title_align":"center","time":{"live_span":"1h"},"type":"query_value","requests":[{"q":"sum:azure.network_loadbalancers.status{sku_name:standard,$region,$resource_group,$subscription_name,$tenant,$lb_name}","aggregator":"max"}],"custom_links":[],"precision":0}},{"id":6,"layout":{"x":47,"y":7,"width":23,"height":8},"definition":{"title":"Basic LBs","title_size":"16","title_align":"center","time":{"live_span":"1h"},"type":"query_value","requests":[{"q":"sum:azure.network_loadbalancers.status{sku_name:basic,$region,$resource_group,$subscription_name,$tenant,$lb_name}","aggregator":"max"}],"autoscale":true,"custom_links":[],"precision":0}},{"id":7,"layout":{"x":120,"y":1,"width":47,"height":5},"definition":{"type":"note","content":"SNAT Connectivity","background_color":"gray","font_size":"18","text_align":"center","show_tick":true,"tick_pos":"50%","tick_edge":"bottom"}},{"id":8,"layout":{"x":120,"y":7,"width":47,"height":24},"definition":{"title":"SNAT Connections","title_size":"16","title_align":"left","show_legend":false,"legend_size":"0","type":"timeseries","requests":[{"q":"sum:azure.network_loadbalancers.snat_connection_count{$region,$resource_group,$subscription_name,$tenant,$lb_name} by {name,resource_group,region}.as_count()","style":{"palette":"dog_classic","line_type":"solid","line_width":"normal"},"display_type":"line"}],"yaxis":{"scale":"linear","label":"","include_zero":true,"min":"auto","max":"auto"},"custom_links":[]}},{"id":9,"layout":{"x":71,"y":73,"width":48,"height":19},"definition":{"title":"Most SYN Packets Received","title_size":"16","title_align":"left","type":"toplist","requests":[{"q":"top(avg:azure.network_loadbalancers.syn_count{direction:in,$region,$resource_group,$subscription_name,$tenant,$lb_name} by {name,resource_group,region}.as_count(), 10, 'mean', 'desc')"}],"custom_links":[]}},{"id":10,"layout":{"x":22,"y":96,"width":48,"height":16},"definition":{"type":"note","content":"VIP refers to data path availability. This measures availability from within a region to the load balancer front end, all the way to the SDN stack that supports your VM.\n\nDIP refers to the health probe status, which indicates how Load Balancer views the health of your application, as indicated by your [health probe configuration](https://docs.microsoft.com/en-us/azure/load-balancer/load-balancer-custom-probe-overview).\n\n[Learn more](https://docs.microsoft.com/en-us/azure/load-balancer/load-balancer-standard-diagnostics#multi-dimensional-metrics)","background_color":"yellow","font_size":"14","text_align":"left","show_tick":false,"tick_pos":"50%","tick_edge":"left"}},{"id":11,"layout":{"x":120,"y":96,"width":47,"height":16},"definition":{"type":"note","content":"SNAT connections refer to outbound connections that are masqueraded to the Public IP address front-end.\n\n[Learn more](https://docs.microsoft.com/en-us/azure/load-balancer/load-balancer-outbound-connections#snat)","background_color":"yellow","font_size":"14","text_align":"left","show_tick":false,"tick_pos":"50%","tick_edge":"left"}},{"id":12,"layout":{"x":120,"y":32,"width":47,"height":19},"definition":{"title":"SNAT Ports Used","title_size":"16","title_align":"left","show_legend":false,"legend_size":"0","type":"timeseries","requests":[{"q":"sum:azure.network_loadbalancers.used_snat_ports_preview{$region,$resource_group,$subscription_name,$tenant,$lb_name} by {name,resource_group,region}.as_count()","style":{"palette":"dog_classic","line_type":"solid","line_width":"normal"},"display_type":"line"}],"yaxis":{"scale":"linear","label":"","include_zero":true,"min":"auto","max":"auto"},"custom_links":[]}},{"id":13,"layout":{"x":71,"y":96,"width":48,"height":16},"definition":{"type":"note","content":"SYN (synchronize) packet counts can help you understand how many TCP connection attempts are made to the VM instance(s) in the Load Balancer backend pool.\n\n[Learn more](https://docs.microsoft.com/en-us/azure/load-balancer/load-balancer-standard-diagnostics)","background_color":"yellow","font_size":"14","text_align":"left","show_tick":false,"tick_pos":"50%","tick_edge":"left"}},{"id":14,"layout":{"x":0,"y":16,"width":21,"height":19},"definition":{"type":"note","content":"Azure Monitor only supplies metrics for Standard Load Balancers. Loadbalancer count and backend pool device count metrics are generated by Datadog and are supplied for both Standard and Basic Loadbalancers.\n\n[Basic vs. Standard Comparison](https://docs.microsoft.com/en-us/azure/load-balancer/load-balancer-overview#skus)","background_color":"yellow","font_size":"14","text_align":"left","show_tick":false,"tick_pos":"50%","tick_edge":"left"}},{"id":15,"layout":{"x":169,"y":34,"width":37,"height":14},"definition":{"type":"note","content":"When SNAT port resources are exhausted, outbound flows fail until existing flows release SNAT ports. Load Balancer reclaims SNAT ports when the flow closes or idles out after 4 minutes.\n\nSeeing SNAT port exhaustion? Review patterns for [mitigating common conditions](https://docs.microsoft.com/en-us/azure/load-balancer/load-balancer-outbound-connections#snatexhaust) that cause this.\n\n","background_color":"yellow","font_size":"14","text_align":"left","show_tick":false,"tick_pos":"50%","tick_edge":"left"}},{"id":16,"layout":{"x":22,"y":16,"width":48,"height":15},"definition":{"title":"Backend Pool Host Count by LB","title_size":"16","title_align":"left","show_legend":false,"type":"timeseries","requests":[{"q":"sum:azure.network_loadbalancers.backend_pool_host_count{$region,$resource_group,$subscription_name,$tenant,$lb_name} by {name,resource_group,region}","style":{"palette":"dog_classic","line_type":"solid","line_width":"normal"},"display_type":"area"}],"yaxis":{"scale":"linear","label":"","include_zero":true,"min":"auto","max":"auto"},"custom_links":[]}},{"id":17,"layout":{"x":120,"y":52,"width":47,"height":19},"definition":{"title":"SNAT Ports Allocated","title_size":"16","title_align":"left","show_legend":false,"legend_size":"0","type":"timeseries","requests":[{"q":"sum:azure.network_loadbalancers.allocated_snat_ports_preview{$region,$resource_group,$subscription_name,$tenant,$lb_name} by {name,resource_group,region}.as_count()","style":{"palette":"dog_classic","line_type":"solid","line_width":"normal"},"display_type":"line"}],"yaxis":{"scale":"linear","label":"","include_zero":true,"min":"auto","max":"auto"},"custom_links":[]}},{"id":18,"layout":{"x":0,"y":1,"width":21,"height":14},"definition":{"type":"image","url":"/static/images/logos/azure-load-balancer_avatar.svg","sizing":"fit","margin":"large"}},{"id":19,"layout":{"x":22,"y":73,"width":48,"height":19},"definition":{"title":"Individual Health Probe Availability","title_size":"16","title_align":"left","type":"toplist","requests":[{"q":"top(avg:azure.network_loadbalancers.health_probe_status{$region,$resource_group,$subscription_name,$tenant,$lb_name} by {resource_group,region,frontendport,backendport,frontendipaddress,backendipaddress,name}, 10, 'mean', 'asc')","conditional_formats":[{"comparator":"<","palette":"white_on_yellow","value":1},{"comparator":"<","palette":"white_on_red","value":50},{"comparator":">=","palette":"white_on_green","value":1}]}],"custom_links":[]}},{"id":20,"layout":{"x":22,"y":53,"width":48,"height":19},"definition":{"title":"DIP Availability","title_size":"16","title_align":"left","show_legend":false,"legend_size":"0","type":"timeseries","requests":[{"q":"avg:azure.network_loadbalancers.health_probe_status{$region,$resource_group,$subscription_name,$tenant,$lb_name} by {name,resource_group,region}","style":{"palette":"warm","line_type":"solid","line_width":"normal"},"display_type":"line"}],"yaxis":{"scale":"linear","label":"","include_zero":true,"min":"auto","max":"auto"},"custom_links":[]}},{"id":21,"layout":{"x":0,"y":73,"width":20,"height":19},"definition":{"type":"note","content":"Health probes with a value of less than 1 indicate potential problems. If the value is 0, you may want to start by verifying that your health probe is configured correctly.","background_color":"yellow","font_size":"14","text_align":"left","show_tick":false,"tick_pos":"50%","tick_edge":"left"}},{"id":22,"layout":{"x":71,"y":32,"width":48,"height":19},"definition":{"title":"Highest Total Network Traffic","title_size":"16","title_align":"left","type":"toplist","requests":[{"q":"top(sum:azure.network_loadbalancers.byte_count{$region,$resource_group,$subscription_name,$tenant,$lb_name} by {region,name,resource_group}.as_count(),10,'mean','desc')"}],"custom_links":[]}},{"id":23,"layout":{"x":120,"y":73,"width":47,"height":19},"definition":{"title":"Highest SNAT Ports Allocated %","title_size":"16","title_align":"left","type":"toplist","requests":[{"q":"top((sum:azure.network_loadbalancers.used_snat_ports_preview{$region,$resource_group,$subscription_name,$tenant,$lb_name} by {name,resource_group,region}/sum:azure.network_loadbalancers.allocated_snat_ports_preview{$region,$resource_group,$subscription_name,$tenant,$lb_name} by {name,resource_group,region})*100,10,'mean','desc')","conditional_formats":[{"comparator":"<","palette":"white_on_green","value":50},{"comparator":"<","palette":"white_on_yellow","value":90},{"comparator":">=","palette":"white_on_red","value":90}]}],"custom_links":[]}}],"template_variables":[{"name":"region","default":"*","prefix":"region"},{"name":"resource_group","default":"*","prefix":"resource_group"},{"name":"subscription_name","default":"*","prefix":"subscription_name"},{"name":"tenant","default":"*","prefix":"tenant_name"},{"name":"lb_name","default":"*","prefix":"name"}],"layout_type":"free","is_read_only":true,"notify_list":[],"id":30310}